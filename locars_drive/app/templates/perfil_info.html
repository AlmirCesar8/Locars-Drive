{% extends 'base.html' %}
{% block title %}Informações Pessoais - LocarsDrive{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/perfil.css') }}">
<script defer src="{{ url_for('static', filename='js/perfil.js') }}"></script>

{% include '_confirm_modal.html' %}

<section class="perfil-main">
  <div class="perfil-wrapper">

    <!-- ======================
         SIDEBAR
    ====================== -->
    <aside class="perfil-sidebar">
      <nav>
        <ul>
          <li><a href="{{ url_for('autenticacao.perfil') }}" class="{% if request.endpoint == 'autenticacao.perfil' %}ativo{% endif %}">Visão Geral</a></li>
          <li><a href="{{ url_for('autenticacao.perfil_info') }}" class="{% if request.endpoint == 'autenticacao.perfil_info' %}ativo{% endif %}">Informações pessoais</a></li>
          <li><a href="{{ url_for('autenticacao.perfil_foto') }}" class="{% if request.endpoint == 'autenticacao.perfil_foto' %}ativo{% endif %}">Alterar foto</a></li>
          <li><a href="{{ url_for('autenticacao.perfil_seguranca') }}" class="{% if request.endpoint == 'autenticacao.perfil_seguranca' %}ativo{% endif %}">Segurança</a></li>
          <li><a href="{{ url_for('autenticacao.perfil_notificacoes') }}" class="{% if request.endpoint == 'autenticacao.perfil_notificacoes' %}ativo{% endif %}">Notificações</a></li>
          <li><a href="{{ url_for('autenticacao.perfil_pagamentos') }}" class="{% if request.endpoint == 'autenticacao.perfil_pagamentos' %}ativo{% endif %}">Assinatura & Pagamentos</a></li>
          <li><a href="{{ url_for('autenticacao.logout') }}" data-confirm="Você tem certeza que deseja sair da sua conta?"id="logout-link">Sair</a></li>
        </ul>
      </nav>
    </aside>

    <!-- ======================
         CONTENT AREA
    ====================== -->
    <div class="perfil-content">

      <!-- HEADER -->
      <div class="perfil-header">
        <div class="perfil-header-inner">
          <div class="perfil-avatar"><i class="fa-solid fa-user"></i></div>
          <div class="perfil-identidade">
            <h1>{{ current_user.nome }}</h1>
            <div class="email">{{ current_user.email }}</div>
          </div>
        </div>
      </div>

      <!-- BODY -->
      <div class="perfil-body">
        <div class="perfil-container">

          <!-- LEFT COLUMN (same as perfil.html) -->
          <aside class="col-left">
            <div class="card info-conta">
              <h3>Informações da Conta</h3>
              <div class="info-row"><i class="fa-regular fa-user"></i><span>{{ current_user.nome }}</span></div>
              <div class="info-row"><i class="fa-regular fa-envelope"></i><span>{{ current_user.email }}</span></div>
              <div class="info-row"><i class="fa-regular fa-calendar"></i><span>Membro desde {{ current_user.data_criacao.strftime('%d/%m/%Y') }}</span></div>
            </div>

            <div class="card assinatura-card">
              <div class="assinatura-top">
                <span class="badge">BÁSICO</span>
                <div class="assinatura-price">R$ 99.90 <span>/mês</span></div>
                <div class="assinatura-valid">Válida até 01/12/2025</div>
              </div>
              <hr>
              <ul class="beneficios">
                <li>10% de desconto em todas as locações</li>
                <li>1 dia grátis por mês</li>
                <li>Cancelamento flexível</li>
              </ul>
            </div>
          </aside>

          <!-- RIGHT COLUMN – EDIT FORM -->
          <div class="col-right">
            <div class="card">
              <h3>Editar Informações Pessoais</h3>

              <form method="POST" action="{{ url_for('autenticacao.perfil_info') }}">
                {{ csrf_token() if csrf_token is defined }}

                <div class="form-group">
                  <label for="nome">Nome completo</label>
                  <input id="nome" name="nome" class="form-control" value="{{ current_user.nome }}" required>
                </div>

                <div class="form-group">
                  <label for="email">Email</label>
                  <input id="email" name="email" type="email" class="form-control" value="{{ current_user.email }}" required>
                </div>

                <div class="form-group">
                  <label for="telefone">Telefone</label>
                  <input id="telefone" name="telefone" class="form-control" value="{{ current_user.telefone or '' }}">
                </div>

                <div class="form-buttons" style="color: #000;">
                  <button type="submit" class="btn btn-primary" style="background-color: #000;">Salvar</button>
                  <a href="{{ url_for('autenticacao.perfil') }}" class="btn btn-secondary">Cancelar</a>
                </div>

              </form>
            </div>
          </div>

        </div>
      </div>

    </div>

  </div>
</section>

{% endblock %}
